{"version":3,"sources":["NoticeAndProduceManager.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"..\\..\\..\\..\\assets\\Script","sourcesContent":["import Singleton from \"./Singleton\";\r\nimport ProduceBasketManager from \"./ProduceBasketManager\";\r\nimport LevelDataManager from \"./LevelDataManager\";\r\n\r\n// Learn TypeScript:\r\n//  - [Chinese] http://docs.cocos.com/creator/manual/zh/scripting/typescript.html\r\n//  - [English] http://www.cocos2d-x.org/docs/creator/manual/en/scripting/typescript.html\r\n// Learn Attribute:\r\n//  - [Chinese] http://docs.cocos.com/creator/manual/zh/scripting/reference/attributes.html\r\n//  - [English] http://www.cocos2d-x.org/docs/creator/manual/en/scripting/reference/attributes.html\r\n// Learn life-cycle callbacks:\r\n//  - [Chinese] http://docs.cocos.com/creator/manual/zh/scripting/life-cycle-callbacks.html\r\n//  - [English] http://www.cocos2d-x.org/docs/creator/manual/en/scripting/life-cycle-callbacks.html\r\n\r\nconst {ccclass, property} = cc._decorator;\r\nlet talefun = (<any>cc).talefun;\r\n\r\n@ccclass\r\nexport default class NoticeAndProduceManager extends Singleton<NoticeAndProduceManager> {\r\n\r\n    @property(cc.Node)\r\n    ballParent:cc.Node;\r\n\r\n    @property(cc.Prefab)\r\n    ballGuide:cc.Prefab;\r\n\r\n    @property(cc.Prefab)\r\n    bombGuide:cc.Prefab;\r\n\r\n    @property(cc.Prefab)\r\n    ball:cc.Prefab;\r\n\r\n    @property(cc.Prefab)\r\n    bomb:cc.Prefab;\r\n\r\n    @property(cc.Node)\r\n    guidePos:cc.Node[] = [];\r\n\r\n    bornPos : cc.Node[] = [];\r\n\r\n    shootPos: number[] = []; // 1代表篮球 2代表炸弹 0代表没有\r\n\r\n    bornSeq: number[] = []; //实例化延迟时间\r\n\r\n    velocity: cc.Vec2[] = [cc.v2(0,2000),cc.v2(0,2500)];\r\n\r\n    ballGuideArray: cc.Node[] = [];\r\n    bombGuideArray: cc.Node[] = [];\r\n    veloctiyY:number = 2000;\r\n\r\n    @property(ProduceBasketManager)\r\n    produceBasketManager:ProduceBasketManager;\r\n\r\n    // LIFE-CYCLE CALLBACKS:\r\n\r\n    // onLoad () {}\r\n\r\n    start () {\r\n      \r\n    }\r\n\r\n\r\n    CreatBornPosByType(posType:number)\r\n    {\r\n        this.bornPos.splice(0,this.bornPos.length);\r\n        switch(posType)\r\n        {\r\n            case -1:\r\n                    this.bornPos.push(this.guidePos[this.random(2,this.guidePos.length)]);\r\n                break;\r\n            case 0:\r\n                 this.bornPos.push(this.random(0,2) == 0 ? this.guidePos[0]:this.guidePos[3]);\r\n                break;\r\n            case 1:\r\n                 this.bornPos.push(this.guidePos[this.random(0,2)]);\r\n                break;\r\n        }\r\n      //  cc.log(\"BornPosLength\" + this.bornPos.length);\r\n    }\r\n\r\n    ///设置生成位置数据\r\n    public SetBornType(pos:number[])\r\n    {\r\n        //清空\r\n        this.bornPos.splice(0,this.bornPos.length);\r\n        for(var i = 0; i < pos.length; i++)\r\n        {\r\n            this.shootPos.push(pos[i]);\r\n        }\r\n    }\r\n\r\n    ///获取创建的位置信息\r\n    CreatBornPos(num:number)\r\n    {\r\n        // this.bornPos.splice(0,this.bornPos.length);\r\n\r\n        // var randomPos:number[] = [];\r\n        // for(var i = 0; i < this.guidePos.length; i++)\r\n        // {\r\n        //     randomPos.push(i);\r\n           \r\n        // }\r\n        // for(var j = 0; j < num; j++)\r\n        // {\r\n        //     var randomValue =  this.random(0,randomPos.length);\r\n        //     var posIndex:number = randomPos[randomValue];\r\n           \r\n           \r\n        //     this.bornPos.push(this.guidePos[posIndex]);\r\n        //     randomPos.slice(randomValue,1);\r\n        // }\r\n     \r\n    }\r\n\r\n    ///获取出场顺序\r\n    CreatBornTypeOrde()\r\n    {\r\n        // this.bornType.slice(0,this.bornType.length);\r\n\r\n        // for(var i = 0; i < this.bornPos.length; i++)\r\n        // {\r\n        //     this.bornType.push(this.random(-1,1));\r\n        // }\r\n\r\n        // var ballOrder = this.random(0,this.bornType.length);\r\n        // this.bornType[ballOrder] = 0;\r\n    }\r\n    \r\n    //创建一个球的发射提示\r\n    ProduceOneBallGuide(posNode:cc.Node):cc.Node\r\n    {\r\n        let bornNode = posNode;\r\n\r\n        let tempball = cc.instantiate(this.ballGuide);\r\n        this.node.addChild(tempball);\r\n        tempball.setPosition(bornNode.position);\r\n        return tempball;\r\n\r\n    }\r\n\r\n    GetShootVelority(angle:number):cc.Vec2\r\n    {\r\n        var anglePI = Math.PI/180 * angle\r\n       \r\n        return cc.v2(this.veloctiyY/Math.tan(anglePI),this.veloctiyY);\r\n    }\r\n\r\n\r\n    //创建一个炸弹的发射提示\r\n    ProduceOneBoomGuide(posNode:cc.Node):cc.Node\r\n    {\r\n        let bornNode = posNode;\r\n\r\n        let tempbomb = cc.instantiate(this.bombGuide);\r\n        this.node.addChild(tempbomb);\r\n        tempbomb.setPosition(bornNode.position);\r\n        return tempbomb;\r\n    }\r\n\r\n    //创建一次球和炸弹的用例\r\n    public ProduceOneBallAndBombCase(shootPos:number[],shootSeq:number[],shootAngel:number [])\r\n    {\r\n\r\n        this.bornPos.splice(0,this.bornPos.length);\r\n        this.ballGuideArray.splice(0,this.ballGuideArray.length);\r\n        this.bombGuideArray.splice(0,this.bombGuideArray.length);\r\n\r\n        for(var i = 0; i < shootPos.length; i++)\r\n        {\r\n            if(shootPos[i] == 1)\r\n            {\r\n                let oneBallGuide = this.ProduceOneBallGuide(this.guidePos[i]);  \r\n                let vel = this.GetShootVelority(shootAngel[i]);//获取射击速度\r\n                this.ballGuideArray.push(oneBallGuide);\r\n               \r\n                this.scheduleOnce(() => {\r\n                    // 这里的 this 指向 component\r\n                    this.ProduceOneShootBallAction(oneBallGuide,vel);\r\n                   \r\n                }, shootSeq[i]/1000.0 + 0.5);//2s后执行一次\r\n\r\n            }\r\n            else if(shootPos[i] == 2)\r\n            {\r\n                let oneBombGuide = this.ProduceOneBoomGuide(this.guidePos[i]);\r\n                let vel = this.GetShootVelority(shootAngel[i]);//获取射击速度\r\n                this.bombGuideArray.push(oneBombGuide);\r\n                this.scheduleOnce(() => {\r\n                    // 这里的 this 指向 component\r\n                    this.ProduceOneShootBombAction(oneBombGuide,vel);\r\n                   \r\n                }, shootSeq[i]/1000.0 + 0.5);//2s后执行一次\r\n            }\r\n        }\r\n        // this.shootPos = \r\n        // // this.CreatBornPos(num);\r\n        // // this.CreatBornTypeOrde();\r\n        // var posType = this.produceBasketManager.GetPosType();\r\n        // this.CreatBornPosByType(posType);\r\n        // for(var i = 0; i < this.bornPos.length; i++)\r\n        // {\r\n        //     var tempball = this.ProduceOneBallGuide(this.bornPos[i]);\r\n        //     this.scheduleOnce(() => {\r\n        //         // 这里的 this 指向 component\r\n        //         this.ProduceBallAction(tempball);\r\n        //     }, 0.5);//2s后执行一次\r\n        // } \r\n\r\n        \r\n\r\n\r\n      //  this.ProduceOneBall(this.bornPos[0],cc.v2(0,2000));\r\n    }\r\n\r\n    //创建一次射球动作\r\n    //velocity表示射球角度\r\n    ProduceOneShootBallAction(guidBall:cc.Node,velocity:cc.Vec2)\r\n    {\r\n       // cc.log(\"Destory\");\r\n        this.ProduceOneBall(guidBall,velocity);\r\n        guidBall.destroy();\r\n      \r\n    }\r\n\r\n\r\n    ProduceOneShootBombAction(guidBall:cc.Node,velocity:cc.Vec2)\r\n    {\r\n       // cc.log(\"Destory\");\r\n        this.ProduceOneBomb(guidBall,velocity);\r\n        guidBall.destroy();\r\n      \r\n    }\r\n\r\n    //创建一个球的\r\n    ProduceOneBall(posNode:cc.Node,velocity:cc.Vec2)\r\n    {\r\n      \r\n        var startPos =  posNode.convertToWorldSpaceAR(cc.v2(0,0));\r\n      \r\n        let tempball = cc.instantiate(this.ball);\r\n        tempball.parent = this.ballParent;\r\n        tempball.position = this.ballParent.convertToNodeSpaceAR(startPos);\r\n        tempball.getComponent<cc.RigidBody>(cc.RigidBody).linearVelocity = velocity;\r\n    }\r\n\r\n\r\n    ProduceOneBomb(posNode:cc.Node,velocity:cc.Vec2)\r\n    {\r\n      \r\n        var startPos =  posNode.convertToWorldSpaceAR(cc.v2(0,0));\r\n      \r\n        let tempball = cc.instantiate(this.bomb);\r\n        tempball.parent = this.ballParent;\r\n        tempball.position = this.ballParent.convertToNodeSpaceAR(startPos);\r\n        tempball.getComponent<cc.RigidBody>(cc.RigidBody).linearVelocity = velocity;\r\n    }\r\n\r\n\r\n    random(lower, upper) {\r\n\r\n        return Math.floor(Math.random() * (upper - lower)) + lower;\r\n        \r\n    }\r\n \r\n\r\n}\r\n"]}