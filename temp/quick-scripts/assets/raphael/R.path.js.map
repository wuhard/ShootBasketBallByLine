{"version":3,"sources":["R.path.js"],"names":["trasform","require","style","utils","smooth","simplify","animate","drawer","M","L","C","Z","sqrt","Math","max","abs","selectedColor","cc","color","PathDefine","extends","Component","properties","_dirty","default","serializable","notify","parent","_commands","points","undefined","init","ctx","showHandles","showBoundingBox","onLoad","_ccsg","GraphicsNode","node","_sgNode","addChild","_applyStyle","ellipse","cx","cy","rx","ry","cmds","push","circle","r","rect","x","y","w","h","close","closed","length","clear","lastPoint","i","ii","point","makePath","R","path2curve","path","getPathString","commands","string","join","getTotalLength","totalLength","_analysis","getBbox","bbox","getWorldBbox","worldBbox","_transformDirty","center","position","add","p","width","height","_curves","curves","subCurves","cmd","c","subPoints","tessTolSclae","scale","j","jj","curve","tesselateBezier","lastx","lasty","dx","dy","minx","miny","maxx","maxy","rectApplyAffineTransform","getTransform","getWorldTransform","_drawCommands","t","_transformCommand","func","apply","_drawHandles","prev","size","half","originLineWidth","lineWidth","originStrokeColor","strokeColor","originFillColor","fillColor","drawHandle","x1","y1","x2","y2","moveTo","lineTo","stroke","fill","fillRect","_drawDashPath","dashArray","dashOffset","drawDashPoints","update","dt","_updateAnimate","getStyledColor","beginPath","Path","Class","defineClass","forEach","prototype","l","arguments"],"mappings":"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","file":"R.path.js","sourceRoot":"..\\..\\..\\..\\assets\\raphael","sourcesContent":["'use strict';\r\n\r\nvar trasform = require('./component/R.transform');\r\nvar style = require('./component/R.style');\r\nvar utils = require('./utils/R.utils');\r\n\r\n// optional\r\nvar smooth = require('./component/optional/R.smooth');\r\nvar simplify = require('./component/optional/R.simplify');\r\nvar animate = require('./component/optional/R.animate');\r\n\r\nvar drawer = {\r\n    M: 'moveTo',\r\n    L: 'lineTo',\r\n    C: 'bezierCurveTo',\r\n    Z: 'close',\r\n};\r\n\r\nvar sqrt = Math.sqrt;\r\nvar max  = Math.max;\r\nvar abs  = Math.abs;\r\n\r\nvar selectedColor = cc.color(0,157,236);\r\n\r\n\r\nvar PathDefine = {\r\n    extends: cc.Component,\r\n\r\n    properties: {\r\n        _dirty: {\r\n            default: true,\r\n            serializable: false,\r\n            notify: function () {\r\n                if (this.parent && this._dirty) {\r\n                    this.parent._dirty = true;\r\n                    \r\n                    if (this._commands) {\r\n                        this._commands.points = undefined;\r\n                    }\r\n                }\r\n            }\r\n        }\r\n    },\r\n\r\n    init: function (parent) {\r\n        if (parent) {\r\n            this.parent = parent;\r\n            this.ctx = parent.ctx;\r\n        }\r\n\r\n        this._commands = [];\r\n        this._dirty = true;\r\n\r\n        this.showHandles = false;\r\n        this.showBoundingBox = false;\r\n    },\r\n\r\n    onLoad: function () {\r\n        this.init();\r\n\r\n        if (!this.ctx) {\r\n            this.ctx = new _ccsg.GraphicsNode();\r\n            this.node._sgNode.addChild(this.ctx);\r\n\r\n            this._applyStyle();\r\n        }\r\n    },\r\n\r\n    ////////////////////////////////////////////\r\n    ellipse: function (cx, cy, rx, ry) {\r\n        if (!ry) {\r\n            ry = rx;\r\n        }\r\n        \r\n        let cmds = this._commands;\r\n        cmds.push(['M', cx, cy]);\r\n        cmds.push(['m', 0, -ry]);\r\n        cmds.push(['a', rx, ry, 0, 1, 1, 0, 2 * ry]);\r\n        cmds.push(['a', rx, ry, 0, 1, 1, 0, -2 * ry]);\r\n        // cmds.push(['z']);\r\n    },\r\n\r\n    circle: function (cx, cy, r) {\r\n        this.ellipse(cx, cy, r);\r\n    },\r\n\r\n    rect: function (x, y, w, h, r) {\r\n        let cmds = this._commands;\r\n\r\n        if (r) {\r\n            cmds.push(['M', x + r, y]);\r\n            cmds.push(['l', w - r * 2, 0]);\r\n            cmds.push(['a', r, r, 0, 0, 1, r, r]);\r\n            cmds.push(['l', 0, h - r * 2]);\r\n            cmds.push(['a', r, r, 0, 0, 1, -r, r]);\r\n            cmds.push(['l', r * 2 - w, 0]);\r\n            cmds.push(['a', r, r, 0, 0, 1, -r, -r]);\r\n            cmds.push(['l', 0, r * 2 - h]);\r\n            cmds.push(['a', r, r, 0, 0, 1, r, -r]);\r\n        }\r\n        else {\r\n            cmds.push(['M', x, y]);\r\n            cmds.push(['l', w, 0]);\r\n            cmds.push(['l', 0, h]);\r\n            cmds.push(['l', -w, 0]);\r\n        }\r\n\r\n        cmds.push(['z']);\r\n    },\r\n\r\n    close: function () {\r\n        this._commands.push(['Z']);\r\n    },\r\n\r\n    points: function (points, closed) {\r\n        if (points.length <= 1) {\r\n            return;\r\n        }\r\n\r\n        this.clear();\r\n\r\n        var lastPoint = points[0];\r\n        this.M(lastPoint.x, lastPoint.y);\r\n\r\n        for (var i = 1, ii = points.length; i < ii; i++) {\r\n            var point = points[i];\r\n            this.C(lastPoint.x, lastPoint.y, point.x, point.y, point.x, point.y);\r\n            lastPoint = point;\r\n        }\r\n\r\n        if (closed) {\r\n            this.C(lastPoint.x, lastPoint.y, points[0].x, points[0].y, points[0].x, points[0].y);\r\n        }\r\n\r\n        this.makePath();\r\n    },\r\n\r\n    makePath: function () {\r\n        this._commands = R.utils.path2curve(this._commands);\r\n        this._dirty = true;\r\n    },\r\n\r\n    path: function (path) {\r\n        this._commands = R.utils.path2curve(path);\r\n        this._dirty = true;\r\n    },\r\n\r\n    clear: function () {\r\n        this._commands.length = 0;\r\n    },\r\n\r\n    getPathString: function () {\r\n        var commands = this._commands;\r\n        var string = [];\r\n\r\n        for (var i = 0, ii = commands.length; i < ii; i++) {\r\n            string[i] = commands[i].join(' ');\r\n        }\r\n        string = string.join(' ');\r\n        return string;\r\n    },\r\n\r\n    getTotalLength: function () {\r\n        if (this._commands.totalLength === undefined) {\r\n            this._analysis();\r\n        }\r\n\r\n        return this._commands.totalLength;\r\n    },\r\n\r\n    getBbox: function () {\r\n        if (this._commands.bbox === undefined) {\r\n            this._analysis();\r\n        }\r\n\r\n        return this._commands.bbox;\r\n    },\r\n\r\n    getWorldBbox: function () {\r\n        if (this._commands.worldBbox === undefined || this._transformDirty) {\r\n            this._analysis();\r\n        }\r\n\r\n        return this._commands.worldBbox;\r\n    },\r\n\r\n    center: function (x, y) {\r\n        x = x || 0;\r\n        y = y || 0;\r\n        \r\n        var bbox = this.getBbox();\r\n        this.position = this.position.add(cc.p(-bbox.width/2 - bbox.x + x, -bbox.height/2 - bbox.y + y));\r\n    },\r\n\r\n    _curves: function () {\r\n        var cmds = this._commands;\r\n        if (cmds.curves) return cmds.curves;\r\n\r\n        var curves = [];\r\n        var subCurves;\r\n        var x, y;\r\n\r\n        for (var i = 0, ii = cmds.length; i < ii; i++) {\r\n            var cmd = cmds[i];\r\n            var c = cmd[0];\r\n            \r\n            if (c === 'M') {\r\n                subCurves = [];\r\n                curves.push(subCurves);\r\n\r\n                x = cmd[1];\r\n                y = cmd[2];\r\n            }\r\n            else if (c === 'C' && x !== undefined && y !== undefined) {\r\n                subCurves.push([x, y, cmd[1], cmd[2], cmd[3], cmd[4], cmd[5], cmd[6]]);\r\n\r\n                x = cmd[5];\r\n                y = cmd[6];\r\n            }\r\n        }\r\n\r\n        cmds.curves = curves;\r\n        return curves;\r\n    },\r\n\r\n    _analysis: function () {\r\n        var cmds = this._commands;\r\n        if (cmds.points) {\r\n            return;\r\n        }\r\n\r\n        var curves = this._curves();\r\n\r\n        var points = [];\r\n        var x, y;\r\n        var subPoints;\r\n        var tessTolSclae = 1/max(abs(this.scale.x), abs(this.scale.y));\r\n\r\n        for (var i = 0, ii = curves.length; i < ii; i++) {\r\n            var subCurves = curves[i];\r\n            subPoints = [];\r\n            points.push(subPoints);\r\n\r\n            for (var j = 0, jj = subCurves.length; j < jj; j++) {\r\n                var curve = subCurves[j];\r\n                R.utils.tesselateBezier(curve[0], curve[1], curve[2], curve[3], curve[4], curve[5], curve[6], curve[7], 0, subPoints, tessTolSclae);\r\n            }\r\n        }\r\n\r\n        cmds.points = points;\r\n\r\n        var totalLength = 0;\r\n        var lastx, lasty;\r\n        var dx, dy;\r\n        var minx = 10e7, miny = 10e7, \r\n            maxx = -10e7, maxy = -10e7;\r\n\r\n        for (var i = 0, ii = points.length; i < ii; i++) {\r\n            subPoints = points[i];\r\n\r\n            for (var j = 0, jj = subPoints.length / 2; j < jj; j++) {\r\n                x = subPoints[j*2];\r\n                y = subPoints[j*2 + 1];\r\n\r\n                if (x < minx) minx = x;\r\n                if (x > maxx) maxx = x;\r\n\r\n                if (y < miny) miny = y;\r\n                if (y > maxy) maxy = y;\r\n\r\n                if (j === 0) {\r\n                    lastx = x;\r\n                    lasty = y;\r\n                }\r\n\r\n                dx = x - lastx;\r\n                dy = y - lasty;\r\n\r\n                totalLength += sqrt(dx*dx + dy*dy);\r\n\r\n                lastx = x;\r\n                lasty = y;\r\n            }\r\n        }\r\n\r\n        cmds.totalLength = totalLength;\r\n\r\n        if (totalLength === 0) {\r\n            cmds.bbox = cmds.worldBbox = cc.rect();\r\n        }\r\n        else {\r\n            var rect = cc.rect(minx, miny, maxx - minx, maxy - miny);\r\n            cmds.bbox = cc.rectApplyAffineTransform(rect, this.getTransform());\r\n            cmds.worldBbox = cc.rectApplyAffineTransform(rect, this.getWorldTransform());\r\n        }\r\n    },\r\n\r\n    //////////////////////////////////////\r\n    _drawCommands: function () {\r\n        var commands = this._commands;\r\n        var ctx = this.ctx;\r\n        var t = this.getWorldTransform();\r\n\r\n        for (var i = 0, ii = commands.length; i < ii; i++) {\r\n            var cmd = commands[i];\r\n            var c = cmd[0];\r\n            cmd = this._transformCommand(cmd, t);\r\n\r\n            var func = ctx[ drawer[c] ];\r\n\r\n            if (func) func.apply(ctx, cmd);\r\n        }\r\n    },\r\n\r\n    _drawHandles: function () {\r\n        var ctx = this.ctx;\r\n        var commands = this._commands;\r\n\r\n        var prev;\r\n        var size = 5;\r\n        var half = size / 2;\r\n\r\n        var originLineWidth = ctx.lineWidth;\r\n        var originStrokeColor = ctx.strokeColor;\r\n        var originFillColor   = ctx.fillColor;\r\n\r\n        ctx.lineWidth = 1;\r\n        ctx.strokeColor = selectedColor;\r\n        ctx.fillColor = selectedColor;\r\n\r\n        var t = this.getWorldTransform();\r\n\r\n        function drawHandle(x1, y1, x2, y2) {\r\n            ctx.moveTo(x1, y1);\r\n            ctx.lineTo(x2, y2);\r\n            ctx.stroke();\r\n            ctx.circle(x2, y2, half);\r\n            ctx.fill();\r\n        }\r\n\r\n        for (var i = 0, ii = commands.length; i < ii; i++) {\r\n            var cmd = commands[i];\r\n            var c = cmd[0];\r\n            cmd = this._transformCommand(cmd, t);\r\n\r\n            if (c === 'M') {\r\n                prev = cmd;\r\n            }\r\n            else if(c === 'C') {\r\n                drawHandle(prev[0], prev[1], cmd[0], cmd[1]);\r\n                drawHandle(cmd[4], cmd[5], cmd[2], cmd[3]);\r\n                prev = [cmd[4], cmd[5]];\r\n            }\r\n\r\n            if (prev)\r\n                ctx.fillRect(prev[0]-half, prev[1]-half, size, size);\r\n        }\r\n\r\n        ctx.lineWidth = originLineWidth;\r\n        ctx.strokeColor = originStrokeColor;\r\n        ctx.fillColor   = originFillColor;\r\n    },\r\n\r\n    _drawDashPath: function () {\r\n        var cmds = this._commands;\r\n        var ctx = this.ctx;\r\n        var dashArray = this.dashArray;\r\n        var dashOffset = this.dashOffset;\r\n\r\n        var points;\r\n\r\n        if (!cmds.points) {\r\n            this._analysis();\r\n        }\r\n\r\n        points = cmds.points;\r\n\r\n        var t = this.getWorldTransform();\r\n        for (var i = 0, ii = points.length; i < ii; i++) {\r\n            var subPoints = points[i];\r\n\r\n            R.utils.drawDashPoints(subPoints, ctx, dashArray, dashOffset, t);\r\n        }\r\n    },\r\n\r\n    //////////////////////////////////////\r\n    update: function (dt) {\r\n        if (this._updateAnimate) {\r\n            this._updateAnimate(dt);\r\n        }\r\n        \r\n        if ( this._commands.length === 0 || !this._dirty || (this.parent && !this.parent._dirty)) {\r\n            return;\r\n        }\r\n\r\n        this._applyStyle();\r\n\r\n        if (!this.parent) {\r\n            this.ctx.clear();\r\n        }\r\n\r\n        if (this.dashArray.length > 0) {\r\n            if (this.getStyledColor('fillColor')) {\r\n                this._drawCommands();\r\n                this.ctx.fill();\r\n            }\r\n\r\n            if (this.getStyledColor('strokeColor')) {\r\n                this.ctx.beginPath();\r\n                this._drawDashPath();\r\n                this.ctx.stroke();\r\n            }\r\n        }\r\n        else {\r\n            this._drawCommands();\r\n\r\n            if (this.getStyledColor('fillColor')) this.ctx.fill();\r\n            if (this.getStyledColor('strokeColor')) this.ctx.stroke();\r\n        }\r\n\r\n        if (this.showBoundingBox) {\r\n            var bbox = this.getWorldBbox();\r\n            this.ctx.rect(bbox.x, bbox.y, bbox.width, bbox.height);\r\n            this.ctx.stroke();\r\n        }\r\n\r\n        if ( this.showHandles ) this._drawHandles();\r\n\r\n        this._dirty = false;\r\n    }\r\n};\r\n\r\nvar Path = cc.Class(utils.defineClass(PathDefine, trasform, style, smooth, simplify, animate));\r\n\r\n['M', 'm', 'L', 'l', 'H', 'h', 'V', 'v', 'C', 'c', 'S', 's', 'Q', 'q', 'T', 't', 'A', 'a', 'Z','z'].forEach(function (cmd) {\r\n    Path.prototype[cmd] = function () {\r\n        var cmds = [cmd];\r\n        for (var i = 0, l = arguments.length; i < l; i++) {\r\n            cmds[i+1] = arguments[i];\r\n        }\r\n        this._commands.push(cmds);\r\n    };\r\n});\r\n"]}